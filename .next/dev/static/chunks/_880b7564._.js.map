{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/erpai/projects/MotorTrust-Frontend/lib/shops.ts"],"sourcesContent":["import { TokenManager } from './auth';\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000';\r\n\r\n// Helper to get full image URL\r\nexport function getImageUrl(path: string): string {\r\n  if (!path) return '';\r\n  // If already a full URL, return as is\r\n  if (path.startsWith('http://') || path.startsWith('https://')) {\r\n    return path;\r\n  }\r\n  // Remove leading slash if present for consistent joining\r\n  const cleanPath = path.startsWith('/') ? path.slice(1) : path;\r\n  return `${API_BASE_URL}/${cleanPath}`;\r\n}\r\n\r\n// Repair Lead types\r\nexport interface RepairLeadUser {\r\n  first_name: string;\r\n  last_name: string;\r\n  phone?: string;\r\n  email?: string;\r\n}\r\n\r\nexport type UrgencyLevel = 'low' | 'normal' | 'high' | 'urgent';\r\n\r\nexport interface RepairLead {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  car_make: string;\r\n  car_model: string;\r\n  car_year: number;\r\n  urgency: UrgencyLevel;\r\n  status: 'open' | 'in_progress' | 'completed' | 'cancelled';\r\n  proposal_count: number;\r\n  images?: string[];\r\n  user?: RepairLeadUser;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface CreateRepairLeadRequest {\r\n  title: string;\r\n  description: string;\r\n  car_make: string;\r\n  car_model: string;\r\n  car_year: number;\r\n  urgency: UrgencyLevel;\r\n  images?: File[];\r\n}\r\n\r\n// Proposal types\r\nexport interface ShopInfo {\r\n  id: number;\r\n  shop_name: string;\r\n  phone?: string;\r\n  email?: string;\r\n  rating?: number;\r\n  address?: string;\r\n}\r\n\r\nexport interface Proposal {\r\n  id: number;\r\n  repair_lead_id: number;\r\n  shop_id?: number;\r\n  shop?: ShopInfo;\r\n  message: string;\r\n  estimated_cost: number;\r\n  estimated_duration?: string;\r\n  warranty_period?: string;\r\n  status: 'pending' | 'accepted' | 'rejected';\r\n  notes?: string;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface CreateProposalRequest {\r\n  repair_lead_id: number;\r\n  message: string;\r\n  estimated_cost: number;\r\n  estimated_duration?: string;\r\n  warranty_period?: string;\r\n}\r\n\r\nexport interface RepairStats {\r\n  total_leads?: number;\r\n  open_leads?: number;\r\n  total_proposals?: number;\r\n  accepted_proposals?: number;\r\n  total_spent?: number;\r\n  avg_proposal_cost?: number;\r\n}\r\n\r\nexport interface ApiResponse<T> {\r\n  success: boolean;\r\n  message?: string;\r\n  data?: T;\r\n  count?: number;\r\n}\r\n\r\n// Shop types\r\nexport interface Shop {\r\n  id: number;\r\n  shop_name: string;\r\n  shop_address: string;\r\n  phone_number?: string;\r\n  latitude?: number;\r\n  longitude?: number;\r\n  specialities?: string[];\r\n  shop_description?: string;\r\n  verification_status?: 'pending' | 'approved' | 'rejected';\r\n  is_active?: boolean;\r\n  is_verified?: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface CreateShopRequest {\r\n  shop_name: string;\r\n  shop_address: string;\r\n  phone_number?: string;\r\n  latitude?: number;\r\n  longitude?: number;\r\n  specialities?: string[];\r\n  shop_description?: string;\r\n}\r\n\r\nexport class ShopService {\r\n  private static getAuthHeader(): string {\r\n    const token = TokenManager.getToken();\r\n    if (!token) throw new Error('No authentication token found');\r\n    return `Bearer ${token}`;\r\n  }\r\n\r\n  // ==================== SHOP MANAGEMENT ====================\r\n\r\n  // Create a new shop (Shop Owner)\r\n  static async createShop(data: CreateShopRequest): Promise<ApiResponse<{ shop: Shop }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/shops`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to create shop');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get my shop (Shop Owner)\r\n  static async getMyShop(): Promise<ApiResponse<{ shop: Shop | null }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/shops/my-shop`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // 404 means no shop exists yet\r\n      if (response.status === 404) {\r\n        return { success: true, data: { shop: null } };\r\n      }\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch shop');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get all shops\r\n  static async getAllShops(): Promise<ApiResponse<{ shops: Shop[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/shops`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch shops');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // ==================== REPAIR LEADS ====================\r\n\r\n  // Get all available repair leads (for shop owners to browse)\r\n  static async getLeads(limit = 50): Promise<ApiResponse<{ leads: RepairLead[] }>> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/api/repairs/leads?limit=${limit}`,\r\n      {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': this.getAuthHeader(),\r\n        },\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch leads');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get single repair lead with proposals\r\n  static async getLead(id: number): Promise<ApiResponse<{ lead: RepairLead; proposals: Proposal[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/leads/${id}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch lead');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Create repair lead (Car Owner) - supports image uploads\r\n  static async createLead(data: CreateRepairLeadRequest): Promise<ApiResponse<{ lead: RepairLead }>> {\r\n    const hasImages = data.images && data.images.length > 0;\r\n\r\n    let response: Response;\r\n\r\n    if (hasImages) {\r\n      // Use FormData for multipart upload\r\n      const formData = new FormData();\r\n      formData.append('title', data.title);\r\n      formData.append('description', data.description);\r\n      formData.append('car_make', data.car_make);\r\n      formData.append('car_model', data.car_model);\r\n      formData.append('car_year', data.car_year.toString());\r\n      formData.append('urgency', data.urgency);\r\n      \r\n      // Append each image - using 'images' as field name (matching curl -F \"images=@file\")\r\n      data.images!.forEach((image, index) => {\r\n        console.log(`Appending image ${index}:`, image.name, image.type, image.size);\r\n        formData.append('images', image, image.name);\r\n      });\r\n\r\n      // Debug: Log FormData contents\r\n      console.log('FormData entries:');\r\n      for (const [key, value] of formData.entries()) {\r\n        if (value instanceof File) {\r\n          console.log(`  ${key}: File(${value.name}, ${value.type}, ${value.size} bytes)`);\r\n        } else {\r\n          console.log(`  ${key}: ${value}`);\r\n        }\r\n      }\r\n\r\n      response = await fetch(`${API_BASE_URL}/api/repairs/leads`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': this.getAuthHeader(),\r\n          // Don't set Content-Type - browser will set it with boundary for multipart\r\n        },\r\n        body: formData,\r\n      });\r\n    } else {\r\n      // Use JSON for requests without images\r\n      const { images, ...jsonData } = data;\r\n      response = await fetch(`${API_BASE_URL}/api/repairs/leads`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': this.getAuthHeader(),\r\n        },\r\n        body: JSON.stringify(jsonData),\r\n      });\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to create lead');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get my repair leads (Car Owner)\r\n  static async getMyLeads(): Promise<ApiResponse<{ leads: RepairLead[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/leads/my/all`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch my leads');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // ==================== PROPOSALS ====================\r\n\r\n  // Submit proposal (Shop Owner)\r\n  static async submitProposal(data: CreateProposalRequest): Promise<ApiResponse<{ proposal: Proposal }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to submit proposal');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get my proposals (Shop Owner)\r\n  static async getMyProposals(): Promise<ApiResponse<{ proposals: Proposal[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals/my/all`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch proposals');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Accept proposal (Car Owner)\r\n  static async acceptProposal(id: number, notes?: string): Promise<ApiResponse<{ proposal: Proposal }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals/${id}/accept`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n      body: JSON.stringify({ notes }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to accept proposal');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Reject proposal (Car Owner)\r\n  static async rejectProposal(id: number): Promise<ApiResponse<{ proposal: Proposal }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals/${id}/reject`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to reject proposal');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get repair stats\r\n  static async getStats(): Promise<ApiResponse<RepairStats>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/stats`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch stats');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 264, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/erpai/projects/MotorTrust-Frontend/app/dashboard/shop/setup/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { ShopService, CreateShopRequest } from '@/lib/shops';\r\nimport { AuthService, User } from '@/lib/auth';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nconst SPECIALITIES = [\r\n  { value: 'brake_repair', label: 'Brake Repair', icon: 'üõû' },\r\n  { value: 'engine_repair', label: 'Engine Repair', icon: 'üîß' },\r\n  { value: 'oil_change', label: 'Oil Change', icon: 'üõ¢Ô∏è' },\r\n  { value: 'transmission', label: 'Transmission', icon: '‚öôÔ∏è' },\r\n  { value: 'electrical', label: 'Electrical', icon: '‚ö°' },\r\n  { value: 'body_work', label: 'Body Work', icon: 'üöó' },\r\n  { value: 'tire_service', label: 'Tire Service', icon: 'üîÑ' },\r\n  { value: 'ac_heating', label: 'AC & Heating', icon: '‚ùÑÔ∏è' },\r\n  { value: 'suspension', label: 'Suspension', icon: 'üî©' },\r\n  { value: 'diagnostics', label: 'Diagnostics', icon: 'üìä' },\r\n];\r\n\r\nexport default function ShopSetupPage() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const [formData, setFormData] = useState<CreateShopRequest>({\r\n    shop_name: '',\r\n    shop_address: '',\r\n    phone_number: '',\r\n    shop_description: '',\r\n    specialities: [],\r\n  });\r\n\r\n  useEffect(() => {\r\n    checkAccess();\r\n  }, []);\r\n\r\n  const checkAccess = async () => {\r\n    try {\r\n      const response = await AuthService.getCurrentUser();\r\n      if (response.data) {\r\n        setUser(response.data);\r\n        if (response.data.role !== 'shop_owner') {\r\n          router.push('/dashboard');\r\n          return;\r\n        }\r\n        // Check if shop already exists\r\n        const shopResponse = await ShopService.getMyShop();\r\n        if (shopResponse.data?.shop) {\r\n          router.push('/dashboard/shop');\r\n          return;\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Access check failed:', err);\r\n      router.push('/signup');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const toggleSpeciality = (value: string) => {\r\n    const current = formData.specialities || [];\r\n    if (current.includes(value)) {\r\n      setFormData({ ...formData, specialities: current.filter(s => s !== value) });\r\n    } else {\r\n      setFormData({ ...formData, specialities: [...current, value] });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setSubmitting(true);\r\n    setError('');\r\n\r\n    try {\r\n      await ShopService.createShop(formData);\r\n      router.push('/dashboard');\r\n    } catch (err: unknown) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Failed to create shop';\r\n      setError(errorMessage);\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-black text-white flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"text-6xl mb-4 animate-float\">üè™</div>\r\n          <p className=\"text-gray-400\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (user?.role !== 'shop_owner') {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <div className=\"text-6xl mb-4\">üîí</div>\r\n        <h2 className=\"text-2xl font-bold mb-2\">Access Denied</h2>\r\n        <p className=\"text-gray-400\">Only shop owners can create shops</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-3xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"text-center mb-8\">\r\n        <div className=\"text-6xl mb-4\">üè™</div>\r\n        <h1 className=\"text-3xl font-bold gradient-text mb-2\">Set Up Your Shop</h1>\r\n        <p className=\"text-gray-400\">\r\n          Complete your shop profile to start receiving repair requests\r\n        </p>\r\n      </div>\r\n\r\n      {/* Progress Indicator */}\r\n      <div className=\"glass-strong rounded-2xl p-4 mb-8\">\r\n        <div className=\"flex items-center justify-between text-sm\">\r\n          <div className=\"flex items-center gap-2 text-[#2ec8c6]\">\r\n            <span className=\"w-6 h-6 bg-[#2ec8c6] text-black rounded-full flex items-center justify-center font-bold text-xs\">1</span>\r\n            Create Account\r\n          </div>\r\n          <div className=\"flex-1 h-0.5 bg-[#2ec8c6] mx-4\"></div>\r\n          <div className=\"flex items-center gap-2 text-[#2ec8c6]\">\r\n            <span className=\"w-6 h-6 bg-[#2ec8c6] text-black rounded-full flex items-center justify-center font-bold text-xs\">2</span>\r\n            Shop Details\r\n          </div>\r\n          <div className=\"flex-1 h-0.5 bg-gray-700 mx-4\"></div>\r\n          <div className=\"flex items-center gap-2 text-gray-500\">\r\n            <span className=\"w-6 h-6 bg-gray-700 rounded-full flex items-center justify-center font-bold text-xs\">3</span>\r\n            Start Receiving Leads\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Form */}\r\n      <div className=\"glass-strong rounded-2xl p-8\">\r\n        {error && (\r\n          <div className=\"mb-6 p-4 glass rounded-lg border border-red-500/30 bg-red-500/10 text-red-400\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n          {/* Shop Name */}\r\n          <div>\r\n            <label className=\"block text-sm font-semibold mb-2\">Shop Name *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={formData.shop_name}\r\n              onChange={(e) => setFormData({ ...formData, shop_name: e.target.value })}\r\n              placeholder=\"e.g., Auto Fix Pro\"\r\n              className=\"w-full glass rounded-lg px-4 py-3 bg-transparent border border-gray-700 focus:border-[#2ec8c6] focus:outline-none\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Shop Address */}\r\n          <div>\r\n            <label className=\"block text-sm font-semibold mb-2\">Shop Address *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={formData.shop_address}\r\n              onChange={(e) => setFormData({ ...formData, shop_address: e.target.value })}\r\n              placeholder=\"e.g., 123 Main St, New York, NY 10001\"\r\n              className=\"w-full glass rounded-lg px-4 py-3 bg-transparent border border-gray-700 focus:border-[#2ec8c6] focus:outline-none\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Phone Number */}\r\n          <div>\r\n            <label className=\"block text-sm font-semibold mb-2\">Phone Number</label>\r\n            <input\r\n              type=\"tel\"\r\n              value={formData.phone_number}\r\n              onChange={(e) => setFormData({ ...formData, phone_number: e.target.value })}\r\n              placeholder=\"e.g., +1234567890\"\r\n              className=\"w-full glass rounded-lg px-4 py-3 bg-transparent border border-gray-700 focus:border-[#2ec8c6] focus:outline-none\"\r\n            />\r\n          </div>\r\n\r\n          {/* Shop Description */}\r\n          <div>\r\n            <label className=\"block text-sm font-semibold mb-2\">Shop Description</label>\r\n            <textarea\r\n              value={formData.shop_description}\r\n              onChange={(e) => setFormData({ ...formData, shop_description: e.target.value })}\r\n              placeholder=\"Tell customers about your shop, experience, and what makes you special...\"\r\n              rows={4}\r\n              className=\"w-full glass rounded-lg px-4 py-3 bg-transparent border border-gray-700 focus:border-[#2ec8c6] focus:outline-none resize-none\"\r\n            />\r\n          </div>\r\n\r\n          {/* Specialities */}\r\n          <div>\r\n            <label className=\"block text-sm font-semibold mb-3\">\r\n              Specialities <span className=\"text-gray-500 font-normal\">(select all that apply)</span>\r\n            </label>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\r\n              {SPECIALITIES.map((spec) => (\r\n                <button\r\n                  key={spec.value}\r\n                  type=\"button\"\r\n                  onClick={() => toggleSpeciality(spec.value)}\r\n                  className={`p-3 rounded-xl border-2 transition-all text-left ${\r\n                    formData.specialities?.includes(spec.value)\r\n                      ? 'border-[#2ec8c6] bg-[#2ec8c6]/10'\r\n                      : 'border-gray-700 hover:border-gray-600'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-xl\">{spec.icon}</span>\r\n                    <span className=\"text-sm font-medium\">{spec.label}</span>\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Submit */}\r\n          <div className=\"pt-4\">\r\n            <button\r\n              type=\"submit\"\r\n              disabled={submitting}\r\n              className=\"w-full py-4 bg-[#2ec8c6] hover:bg-[#26a5a3] text-black font-bold rounded-xl transition-all disabled:opacity-50 text-lg\"\r\n            >\r\n              {submitting ? (\r\n                <span className=\"flex items-center justify-center gap-2\">\r\n                  <span className=\"animate-spin\">‚è≥</span>\r\n                  Creating Shop...\r\n                </span>\r\n              ) : (\r\n                'Create My Shop'\r\n              )}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n\r\n      {/* Help Text */}\r\n      <div className=\"text-center mt-6 text-gray-500 text-sm\">\r\n        <p>Your shop will be automatically approved and ready to receive leads!</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}
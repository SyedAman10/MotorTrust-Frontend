{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/erpai/projects/MotorTrust-Frontend/lib/shops.ts"],"sourcesContent":["import { TokenManager } from './auth';\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000';\r\n\r\n// Helper to get full image URL\r\nexport function getImageUrl(path: string): string {\r\n  if (!path) return '';\r\n  // If already a full URL, return as is\r\n  if (path.startsWith('http://') || path.startsWith('https://')) {\r\n    return path;\r\n  }\r\n  // Remove leading slash if present for consistent joining\r\n  const cleanPath = path.startsWith('/') ? path.slice(1) : path;\r\n  return `${API_BASE_URL}/${cleanPath}`;\r\n}\r\n\r\n// Repair Lead types\r\nexport interface RepairLeadUser {\r\n  first_name: string;\r\n  last_name: string;\r\n  phone?: string;\r\n  email?: string;\r\n}\r\n\r\nexport type UrgencyLevel = 'low' | 'normal' | 'high' | 'urgent';\r\n\r\nexport interface RepairLead {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  car_make: string;\r\n  car_model: string;\r\n  car_year: number;\r\n  urgency: UrgencyLevel;\r\n  status: 'open' | 'in_progress' | 'completed' | 'cancelled';\r\n  proposal_count: number;\r\n  images?: string[];\r\n  user?: RepairLeadUser;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface CreateRepairLeadRequest {\r\n  title: string;\r\n  description: string;\r\n  car_make: string;\r\n  car_model: string;\r\n  car_year: number;\r\n  urgency: UrgencyLevel;\r\n  images?: File[];\r\n}\r\n\r\n// Proposal types\r\nexport interface ShopInfo {\r\n  id: number;\r\n  shop_name: string;\r\n  phone?: string;\r\n  email?: string;\r\n  rating?: number;\r\n  address?: string;\r\n}\r\n\r\nexport interface Proposal {\r\n  id: number;\r\n  repair_lead_id: number;\r\n  shop_id?: number;\r\n  shop?: ShopInfo;\r\n  message: string;\r\n  estimated_cost: number;\r\n  estimated_duration?: string;\r\n  warranty_period?: string;\r\n  status: 'pending' | 'accepted' | 'rejected';\r\n  notes?: string;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface CreateProposalRequest {\r\n  repair_lead_id: number;\r\n  message: string;\r\n  estimated_cost: number;\r\n  estimated_duration?: string;\r\n  warranty_period?: string;\r\n}\r\n\r\nexport interface RepairStats {\r\n  total_leads?: number;\r\n  open_leads?: number;\r\n  total_proposals?: number;\r\n  accepted_proposals?: number;\r\n  total_spent?: number;\r\n  avg_proposal_cost?: number;\r\n}\r\n\r\nexport interface ApiResponse<T> {\r\n  success: boolean;\r\n  message?: string;\r\n  data?: T;\r\n  count?: number;\r\n}\r\n\r\n// Shop types\r\nexport interface Shop {\r\n  id: number;\r\n  shop_name: string;\r\n  shop_address: string;\r\n  phone_number?: string;\r\n  latitude?: number;\r\n  longitude?: number;\r\n  specialities?: string[];\r\n  shop_description?: string;\r\n  verification_status?: 'pending' | 'approved' | 'rejected';\r\n  is_active?: boolean;\r\n  is_verified?: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface CreateShopRequest {\r\n  shop_name: string;\r\n  shop_address: string;\r\n  phone_number?: string;\r\n  latitude?: number;\r\n  longitude?: number;\r\n  specialities?: string[];\r\n  shop_description?: string;\r\n}\r\n\r\nexport class ShopService {\r\n  private static getAuthHeader(): string {\r\n    const token = TokenManager.getToken();\r\n    if (!token) throw new Error('No authentication token found');\r\n    return `Bearer ${token}`;\r\n  }\r\n\r\n  // ==================== SHOP MANAGEMENT ====================\r\n\r\n  // Create a new shop (Shop Owner)\r\n  static async createShop(data: CreateShopRequest): Promise<ApiResponse<{ shop: Shop }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/shops`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to create shop');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get my shop (Shop Owner)\r\n  static async getMyShop(): Promise<ApiResponse<{ shop: Shop | null }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/shops/my-shop`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // 404 means no shop exists yet\r\n      if (response.status === 404) {\r\n        return { success: true, data: { shop: null } };\r\n      }\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch shop');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get all shops\r\n  static async getAllShops(): Promise<ApiResponse<{ shops: Shop[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/shops`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch shops');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // ==================== REPAIR LEADS ====================\r\n\r\n  // Get all available repair leads (for shop owners to browse)\r\n  static async getLeads(limit = 50): Promise<ApiResponse<{ leads: RepairLead[] }>> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/api/repairs/leads?limit=${limit}`,\r\n      {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': this.getAuthHeader(),\r\n        },\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch leads');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get single repair lead with proposals\r\n  static async getLead(id: number): Promise<ApiResponse<{ lead: RepairLead; proposals: Proposal[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/leads/${id}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch lead');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Create repair lead (Car Owner) - supports image uploads\r\n  static async createLead(data: CreateRepairLeadRequest): Promise<ApiResponse<{ lead: RepairLead }>> {\r\n    const hasImages = data.images && data.images.length > 0;\r\n\r\n    let response: Response;\r\n\r\n    if (hasImages) {\r\n      // Use FormData for multipart upload\r\n      const formData = new FormData();\r\n      formData.append('title', data.title);\r\n      formData.append('description', data.description);\r\n      formData.append('car_make', data.car_make);\r\n      formData.append('car_model', data.car_model);\r\n      formData.append('car_year', data.car_year.toString());\r\n      formData.append('urgency', data.urgency);\r\n      \r\n      // Append each image - using 'images' as field name (matching curl -F \"images=@file\")\r\n      data.images!.forEach((image, index) => {\r\n        console.log(`Appending image ${index}:`, image.name, image.type, image.size);\r\n        formData.append('images', image, image.name);\r\n      });\r\n\r\n      // Debug: Log FormData contents\r\n      console.log('FormData entries:');\r\n      for (const [key, value] of formData.entries()) {\r\n        if (value instanceof File) {\r\n          console.log(`  ${key}: File(${value.name}, ${value.type}, ${value.size} bytes)`);\r\n        } else {\r\n          console.log(`  ${key}: ${value}`);\r\n        }\r\n      }\r\n\r\n      response = await fetch(`${API_BASE_URL}/api/repairs/leads`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': this.getAuthHeader(),\r\n          // Don't set Content-Type - browser will set it with boundary for multipart\r\n        },\r\n        body: formData,\r\n      });\r\n    } else {\r\n      // Use JSON for requests without images\r\n      const { images, ...jsonData } = data;\r\n      response = await fetch(`${API_BASE_URL}/api/repairs/leads`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': this.getAuthHeader(),\r\n        },\r\n        body: JSON.stringify(jsonData),\r\n      });\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to create lead');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get my repair leads (Car Owner)\r\n  static async getMyLeads(): Promise<ApiResponse<{ leads: RepairLead[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/leads/my/all`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch my leads');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // ==================== PROPOSALS ====================\r\n\r\n  // Submit proposal (Shop Owner)\r\n  static async submitProposal(data: CreateProposalRequest): Promise<ApiResponse<{ proposal: Proposal }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to submit proposal');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get my proposals (Shop Owner)\r\n  static async getMyProposals(): Promise<ApiResponse<{ proposals: Proposal[] }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals/my/all`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch proposals');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Accept proposal (Car Owner)\r\n  static async acceptProposal(id: number, notes?: string): Promise<ApiResponse<{ proposal: Proposal }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals/${id}/accept`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n      body: JSON.stringify({ notes }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to accept proposal');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Reject proposal (Car Owner)\r\n  static async rejectProposal(id: number): Promise<ApiResponse<{ proposal: Proposal }>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/proposals/${id}/reject`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to reject proposal');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  // Get repair stats\r\n  static async getStats(): Promise<ApiResponse<RepairStats>> {\r\n    const response = await fetch(`${API_BASE_URL}/api/repairs/stats`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': this.getAuthHeader(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error?.message || error.message || 'Failed to fetch stats');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/erpai/projects/MotorTrust-Frontend/app/dashboard/leads/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState, use, useRef, useCallback } from 'react';\r\nimport { ShopService, RepairLead, CreateProposalRequest, getImageUrl } from '@/lib/shops';\r\nimport { AuthService, User } from '@/lib/auth';\r\nimport { useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\n\r\nfunction getUrgencyColor(urgency: string): string {\r\n  switch (urgency) {\r\n    case 'urgent': return 'bg-red-500/20 text-red-400 border-red-500/50';\r\n    case 'high': return 'bg-orange-500/20 text-orange-400 border-orange-500/50';\r\n    case 'normal': return 'bg-blue-500/20 text-blue-400 border-blue-500/50';\r\n    case 'low': return 'bg-gray-500/20 text-gray-400 border-gray-500/50';\r\n    default: return 'bg-gray-500/20 text-gray-400 border-gray-500/50';\r\n  }\r\n}\r\n\r\nfunction getStatusColor(status: string): string {\r\n  switch (status) {\r\n    case 'open': return 'bg-green-500/20 text-green-400 border-green-500/50';\r\n    case 'in_progress': return 'bg-blue-500/20 text-blue-400 border-blue-500/50';\r\n    case 'completed': return 'bg-purple-500/20 text-purple-400 border-purple-500/50';\r\n    case 'cancelled': return 'bg-red-500/20 text-red-400 border-red-500/50';\r\n    default: return 'bg-gray-500/20 text-gray-400 border-gray-500/50';\r\n  }\r\n}\r\n\r\nexport default function LeadDetailPage({ params }: { params: Promise<{ id: string }> }) {\r\n  const { id } = use(params);\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [lead, setLead] = useState<RepairLead | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  \r\n  // Proposal form state\r\n  const [showProposalForm, setShowProposalForm] = useState(false);\r\n  const [proposalMessage, setProposalMessage] = useState('');\r\n  const [estimatedCost, setEstimatedCost] = useState('');\r\n  const [estimatedDays, setEstimatedDays] = useState('');\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [submitError, setSubmitError] = useState('');\r\n  const [submitSuccess, setSubmitSuccess] = useState(false);\r\n  \r\n  // Lightbox state\r\n  const [lightboxOpen, setLightboxOpen] = useState(false);\r\n  const [lightboxIndex, setLightboxIndex] = useState(0);\r\n\r\n  const fetchedRef = useRef(false);\r\n\r\n  const fetchLead = useCallback(async () => {\r\n    try {\r\n      const response = await ShopService.getLead(parseInt(id));\r\n      if (response.success && response.data) {\r\n        setLead(response.data.lead);\r\n      } else {\r\n        setError('Lead not found');\r\n      }\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to load lead');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    if (fetchedRef.current) return;\r\n    fetchedRef.current = true;\r\n\r\n    const initPage = async () => {\r\n      try {\r\n        const response = await AuthService.getCurrentUser();\r\n        if (!response.success || !response.data) {\r\n          router.push('/signup');\r\n          return;\r\n        }\r\n        setUser(response.data);\r\n        fetchLead();\r\n      } catch {\r\n        router.push('/signup');\r\n      }\r\n    };\r\n\r\n    initPage();\r\n  }, [router, fetchLead]);\r\n\r\n  const handleSubmitProposal = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!lead) return;\r\n\r\n    if (proposalMessage.length < 20) {\r\n      setSubmitError('Message must be at least 20 characters');\r\n      return;\r\n    }\r\n\r\n    setSubmitting(true);\r\n    setSubmitError('');\r\n\r\n    try {\r\n      const proposalData: CreateProposalRequest = {\r\n        repair_lead_id: lead.id,\r\n        message: proposalMessage,\r\n        estimated_cost: parseFloat(estimatedCost),\r\n        estimated_days: parseInt(estimatedDays),\r\n      };\r\n\r\n      await ShopService.submitProposal(proposalData);\r\n      setSubmitSuccess(true);\r\n      setShowProposalForm(false);\r\n      // Refresh lead to get updated proposals\r\n      fetchLead();\r\n    } catch (err) {\r\n      setSubmitError(err instanceof Error ? err.message : 'Failed to submit proposal');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const openLightbox = (index: number) => {\r\n    setLightboxIndex(index);\r\n    setLightboxOpen(true);\r\n  };\r\n\r\n  const closeLightbox = () => {\r\n    setLightboxOpen(false);\r\n  };\r\n\r\n  const nextImage = () => {\r\n    if (lead?.images) {\r\n      setLightboxIndex((prev) => (prev + 1) % lead.images.length);\r\n    }\r\n  };\r\n\r\n  const prevImage = () => {\r\n    if (lead?.images) {\r\n      setLightboxIndex((prev) => (prev - 1 + lead.images.length) % lead.images.length);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n        <div className=\"text-center\">\r\n          <div className=\"w-12 h-12 border-4 border-[#2ec8c6] border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-400\">Loading lead details...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !lead) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n        <div className=\"text-center\">\r\n          <div className=\"text-6xl mb-4\">‚ùå</div>\r\n          <h2 className=\"text-xl font-semibold mb-2\">Lead Not Found</h2>\r\n          <p className=\"text-gray-400 mb-6\">{error || 'The lead you are looking for does not exist.'}</p>\r\n          <Link \r\n            href=\"/dashboard/leads\"\r\n            className=\"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-[#2ec8c6] to-[#1a9a99] rounded-xl font-semibold hover:opacity-90 transition-opacity\"\r\n          >\r\n            ‚Üê Back to Leads\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasSubmittedProposal = lead.proposals?.some(\r\n    (p) => p.shop_owner?.id === user?.id\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Link \r\n            href=\"/dashboard/leads\"\r\n            className=\"p-2 glass rounded-lg hover:bg-white/10 transition-colors\"\r\n          >\r\n            ‚Üê\r\n          </Link>\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold\">{lead.title}</h1>\r\n            <p className=\"text-gray-400\">\r\n              {lead.car_year} {lead.car_make} {lead.car_model}\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <span className={`px-3 py-1 rounded-full text-sm font-bold border ${getStatusColor(lead.status)}`}>\r\n            {lead.status.replace('_', ' ')}\r\n          </span>\r\n          <span className={`px-3 py-1 rounded-full text-sm font-bold border ${getUrgencyColor(lead.urgency)}`}>\r\n            {lead.urgency}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Success Message */}\r\n      {submitSuccess && (\r\n        <div className=\"glass rounded-xl p-4 border border-green-500/30 bg-green-500/10\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-2xl\">‚úÖ</span>\r\n            <div>\r\n              <p className=\"font-semibold text-green-400\">Proposal Submitted!</p>\r\n              <p className=\"text-sm text-gray-400\">The car owner will review your proposal and get back to you.</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"grid lg:grid-cols-3 gap-6\">\r\n        {/* Main Content */}\r\n        <div className=\"lg:col-span-2 space-y-6\">\r\n          {/* Description Card */}\r\n          <div className=\"glass rounded-2xl p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\r\n              <span>üìã</span> Issue Description\r\n            </h2>\r\n            <p className=\"text-gray-300 whitespace-pre-wrap leading-relaxed\">\r\n              {lead.description}\r\n            </p>\r\n          </div>\r\n\r\n          {/* Image Gallery */}\r\n          {lead.images && lead.images.length > 0 && (\r\n            <div className=\"glass rounded-2xl p-6\">\r\n              <h2 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\r\n                <span>üì∑</span> Photos ({lead.images.length})\r\n              </h2>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\r\n                {lead.images.map((image, index) => (\r\n                  <button\r\n                    key={index}\r\n                    onClick={() => openLightbox(index)}\r\n                    className=\"relative aspect-square rounded-xl overflow-hidden group hover:ring-2 hover:ring-[#2ec8c6] transition-all\"\r\n                  >\r\n                    <img\r\n                      src={getImageUrl(image)}\r\n                      alt={`Issue photo ${index + 1}`}\r\n                      className=\"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform\"\r\n                    />\r\n                    <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center\">\r\n                      <span className=\"text-white text-2xl opacity-0 group-hover:opacity-100 transition-opacity\">üîç</span>\r\n                    </div>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Proposal Form */}\r\n          {!hasSubmittedProposal && !submitSuccess && lead.status === 'open' && (\r\n            <div className=\"glass rounded-2xl p-6\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <h2 className=\"text-lg font-semibold flex items-center gap-2\">\r\n                  <span>üíº</span> Submit Your Proposal\r\n                </h2>\r\n                {!showProposalForm && (\r\n                  <button\r\n                    onClick={() => setShowProposalForm(true)}\r\n                    className=\"px-4 py-2 bg-gradient-to-r from-[#2ec8c6] to-[#1a9a99] rounded-lg font-semibold hover:opacity-90 transition-opacity\"\r\n                  >\r\n                    Create Proposal\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              {showProposalForm && (\r\n                <form onSubmit={handleSubmitProposal} className=\"space-y-4\">\r\n                  {submitError && (\r\n                    <div className=\"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 text-sm\">\r\n                      {submitError}\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className=\"grid md:grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <label className=\"block text-sm font-semibold mb-2\">Estimated Cost ($) *</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        value={estimatedCost}\r\n                        onChange={(e) => setEstimatedCost(e.target.value)}\r\n                        placeholder=\"e.g., 350.00\"\r\n                        step=\"0.01\"\r\n                        min=\"0\"\r\n                        className=\"w-full glass rounded-lg px-4 py-3 bg-transparent border border-gray-700 focus:border-[#2ec8c6] focus:outline-none transition-colors\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"block text-sm font-semibold mb-2\">Estimated Days *</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        value={estimatedDays}\r\n                        onChange={(e) => setEstimatedDays(e.target.value)}\r\n                        placeholder=\"e.g., 3\"\r\n                        min=\"1\"\r\n                        className=\"w-full glass rounded-lg px-4 py-3 bg-transparent border border-gray-700 focus:border-[#2ec8c6] focus:outline-none transition-colors\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-2\">\r\n                      Your Message *\r\n                      <span className={`ml-2 text-xs ${proposalMessage.length < 20 ? 'text-gray-500' : 'text-green-400'}`}>\r\n                        ({proposalMessage.length}/20 min)\r\n                      </span>\r\n                    </label>\r\n                    <textarea\r\n                      value={proposalMessage}\r\n                      onChange={(e) => setProposalMessage(e.target.value)}\r\n                      placeholder=\"Describe your approach, experience with this type of repair, and what's included in your quote...\"\r\n                      rows={5}\r\n                      minLength={20}\r\n                      className={`w-full glass rounded-lg px-4 py-3 bg-transparent border focus:outline-none transition-colors resize-none ${\r\n                        proposalMessage.length > 0 && proposalMessage.length < 20\r\n                          ? 'border-yellow-500 focus:border-yellow-500'\r\n                          : 'border-gray-700 focus:border-[#2ec8c6]'\r\n                      }`}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex gap-3 pt-2\">\r\n                    <button\r\n                      type=\"submit\"\r\n                      disabled={submitting || proposalMessage.length < 20}\r\n                      className=\"flex-1 py-3 bg-gradient-to-r from-[#2ec8c6] to-[#1a9a99] rounded-xl font-semibold hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                      {submitting ? 'Submitting...' : 'Submit Proposal'}\r\n                    </button>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => setShowProposalForm(false)}\r\n                      className=\"px-6 py-3 glass rounded-xl hover:bg-white/10 transition-colors\"\r\n                    >\r\n                      Cancel\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Already Submitted Message */}\r\n          {hasSubmittedProposal && (\r\n            <div className=\"glass rounded-2xl p-6 border border-blue-500/30 bg-blue-500/10\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <span className=\"text-2xl\">üìù</span>\r\n                <div>\r\n                  <p className=\"font-semibold text-blue-400\">You&apos;ve Already Submitted a Proposal</p>\r\n                  <p className=\"text-sm text-gray-400\">Wait for the car owner to review your proposal.</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Sidebar */}\r\n        <div className=\"space-y-6\">\r\n          {/* Customer Info */}\r\n          <div className=\"glass rounded-2xl p-6\">\r\n            <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n              <span>üë§</span> Customer\r\n            </h3>\r\n            <div className=\"space-y-3\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-400\">Name</p>\r\n                <p className=\"font-medium\">\r\n                  {lead.user?.first_name} {lead.user?.last_name}\r\n                </p>\r\n              </div>\r\n              {lead.user?.city && (\r\n                <div>\r\n                  <p className=\"text-sm text-gray-400\">Location</p>\r\n                  <p className=\"font-medium\">\r\n                    {lead.user.city}{lead.user.state ? `, ${lead.user.state}` : ''}\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Vehicle Info */}\r\n          <div className=\"glass rounded-2xl p-6\">\r\n            <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n              <span>üöó</span> Vehicle\r\n            </h3>\r\n            <div className=\"space-y-3\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-400\">Make & Model</p>\r\n                <p className=\"font-medium\">{lead.car_make} {lead.car_model}</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-gray-400\">Year</p>\r\n                <p className=\"font-medium\">{lead.car_year}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Lead Stats */}\r\n          <div className=\"glass rounded-2xl p-6\">\r\n            <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n              <span>üìä</span> Lead Info\r\n            </h3>\r\n            <div className=\"space-y-3\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-400\">Posted</p>\r\n                <p className=\"font-medium\">\r\n                  {new Date(lead.created_at).toLocaleDateString('en-US', {\r\n                    month: 'short',\r\n                    day: 'numeric',\r\n                    year: 'numeric',\r\n                  })}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-gray-400\">Proposals</p>\r\n                <p className=\"font-medium\">{lead.proposal_count || lead.proposals?.length || 0}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quick Actions */}\r\n          {!hasSubmittedProposal && !submitSuccess && lead.status === 'open' && (\r\n            <button\r\n              onClick={() => {\r\n                setShowProposalForm(true);\r\n                window.scrollTo({ top: 0, behavior: 'smooth' });\r\n              }}\r\n              className=\"w-full py-4 bg-gradient-to-r from-[#2ec8c6] to-[#1a9a99] rounded-xl font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2\"\r\n            >\r\n              <span>üíº</span> Submit Proposal\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Lightbox */}\r\n      {lightboxOpen && lead.images && lead.images.length > 0 && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/95 z-50 flex items-center justify-center\"\r\n          onClick={closeLightbox}\r\n        >\r\n          {/* Close button */}\r\n          <button\r\n            onClick={closeLightbox}\r\n            className=\"absolute top-4 right-4 p-3 glass rounded-full hover:bg-white/20 transition-colors text-2xl z-10\"\r\n          >\r\n            ‚úï\r\n          </button>\r\n\r\n          {/* Counter */}\r\n          <div className=\"absolute top-4 left-1/2 -translate-x-1/2 glass rounded-full px-4 py-2 font-semibold\">\r\n            {lightboxIndex + 1} / {lead.images.length}\r\n          </div>\r\n\r\n          {/* Navigation arrows */}\r\n          {lead.images.length > 1 && (\r\n            <>\r\n              <button\r\n                onClick={(e) => { e.stopPropagation(); prevImage(); }}\r\n                className=\"absolute left-4 p-3 glass rounded-full hover:bg-white/20 transition-colors text-2xl\"\r\n              >\r\n                ‚Üê\r\n              </button>\r\n              <button\r\n                onClick={(e) => { e.stopPropagation(); nextImage(); }}\r\n                className=\"absolute right-4 p-3 glass rounded-full hover:bg-white/20 transition-colors text-2xl\"\r\n              >\r\n                ‚Üí\r\n              </button>\r\n            </>\r\n          )}\r\n\r\n          {/* Main image */}\r\n          <div \r\n            className=\"relative w-full h-full max-w-4xl max-h-[80vh] mx-16 flex items-center justify-center\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <img\r\n              src={getImageUrl(lead.images[lightboxIndex])}\r\n              alt={`Issue photo ${lightboxIndex + 1}`}\r\n              className=\"max-w-full max-h-full object-contain\"\r\n            />\r\n          </div>\r\n\r\n          {/* Thumbnail strip */}\r\n          {lead.images.length > 1 && (\r\n            <div \r\n              className=\"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2\"\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              {lead.images.map((image, index) => (\r\n                <button\r\n                  key={index}\r\n                  onClick={() => setLightboxIndex(index)}\r\n                  className={`w-16 h-16 rounded-lg overflow-hidden relative transition-all ${\r\n                    index === lightboxIndex \r\n                      ? 'ring-2 ring-[#2ec8c6] scale-110' \r\n                      : 'opacity-60 hover:opacity-100'\r\n                  }`}\r\n                >\r\n                  <img\r\n                    src={getImageUrl(image)}\r\n                    alt={`Thumbnail ${index + 1}`}\r\n                    className=\"absolute inset-0 w-full h-full object-cover\"\r\n                  />\r\n                </button>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}